!function(){var t={760:function(t){t.exports={XMLSerializer:window.XMLSerializer,DOMParser:window.DOMParser,XMLDocument:window.XMLDocument}},712:function(t){t.exports=function t(e,r,n){for(var o={},i=0,a=e.length;i<a;i++){var s=e[i],u=s.getAttribute("ContentType");o[s.getAttribute("PartName").substr(1)]=u}for(var l=0,p=r.length;l<p;l++)!function t(){var e=r[l],i=e.getAttribute("ContentType"),a=e.getAttribute("Extension");n.file(/./).map(function(t){var e=t.name;e.slice(e.length-a.length)!==a||o[e]||"[Content_Types].xml"===e||(o[e]=i)})}();return o}},731:function(t){t.exports={settingsContentType:"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",coreContentType:"application/vnd.openxmlformats-package.core-properties+xml",appContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml",customContentType:"application/vnd.openxmlformats-officedocument.custom-properties+xml"}},557:function(t,e,r){function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var o=r(760),i=o.DOMParser,a=o.XMLSerializer,s=r(257).throwXmlTagNotFound,u=r(287),l=u.last,p=u.first,c={},f=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],h=f.map(function(t){var e,r=function t(e){if(Array.isArray(e))return e}(e=t)||function t(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,s,u=[],l=!0,p=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(u.push(o.value),u.length!==r);l=!0);}catch(c){p=!0,i=c}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(p)throw i}}return u}}(e,2)||function t(e,r){if(e){if("string"==typeof e)return n(e,r);var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(e,r)}}(e,2)||function t(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=r[0],i=r[1];return{rstart:RegExp(i,"g"),rend:RegExp(o,"g"),start:i,end:o}}),d=RegExp("\xa0","g");function v(t,e){return t==="</"+e+">"}function g(t,e){return 0===t.indexOf("<"+e)&&-1!==[">"," ","/"].indexOf(t[e.length+1])}function m(t,e,r){"string"==typeof e&&(e=[e]);for(var n=1,o=r,i=t.length;o<i;o++)for(var a=t[o],s=0,u=e.length;s<u;s++){var l=e[s];if(v(a.value,l)&&n--,g(a.value,l)&&n++,0===n)return o}return null}function y(t,e,r){"string"==typeof e&&(e=[e]);for(var n=1,o=r;o>=0;o--)for(var i=t[o],a=0,s=e.length;a<s;a++){var u=e[a];if(g(i.value,u)&&n--,v(i.value,u)&&n++,0===n)return o}return null}function x(t,e){var r=e.type,n=e.tag,o=e.position;return"tag"===r&&n===t&&"start"===o}function $(t,e){var r=e.type,n=e.tag,o=e.position;return"tag"===r&&n===t&&"end"===o}var w=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;t.exports={endsWith:function t(e,r){return -1!==e.indexOf(r,e.length-r.length)},startsWith:function t(e,r){return e.substring(0,r.length)===r},isContent:function t(e){var r=e.type,n=e.position;return"placeholder"===r||"content"===r&&"insidetag"===n},isParagraphStart:function t(e){return x("w:p",e)||x("a:p",e)},isParagraphEnd:function t(e){return $("w:p",e)||$("a:p",e)},isTagStart:function t(e,r){var n=r.type,o=r.tag,i=r.position;return"tag"===n&&o===e&&("start"===i||"selfclosing"===i)},isTagEnd:$,isTextStart:function t(e){var r=e.type,n=e.position,o=e.text;return"tag"===r&&"start"===n&&o},isTextEnd:function t(e){var r=e.type,n=e.position,o=e.text;return"tag"===r&&"end"===n&&o},isStarting:g,isEnding:v,isModule:function t(e,r){var n,o=e.module;return r instanceof Array||(r=[r]),"placeholder"===e.type&&-1!==r.indexOf(o)},uniq:function t(e){for(var r={},n=[],o=0,i=e.length;o<i;++o)r[e[o]]||(r[e[o]]=!0,n.push(e[o]));return n},getDuplicates:function t(e){for(var r=[],n={},o=[],i=0,a=e.length;i<a;++i)n[e[i]]?r.push(e[i]):(n[e[i]]=!0,o.push(e[i]));return r},chunkBy:function t(e,r){return e.reduce(function(t,e){var n=l(t),o=r(e);return"start"===o?t.push([e]):"end"===o?(n.push(e),t.push([])):n.push(e),t},[[]]).filter(function(t){return t.length>0})},last:l,first:p,xml2str:function t(e){return new a().serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function t(e){return 65279===e.charCodeAt(0)&&(e=e.substr(1)),new i().parseFromString(e,"text/xml")},getRightOrNull:m,getRight:function t(e,r,n){var o=m(e,r,n);if(null!==o)return o;s({position:"right",element:r,parsed:e,index:n})},getLeftOrNull:y,getLeft:function t(e,r,n){var o=y(e,r,n);if(null!==o)return o;s({position:"left",element:r,parsed:e,index:n})},pregMatchAll:function t(e,r){for(var n,o=[];null!=(n=e.exec(r));)o.push({array:n,offset:n.index});return o},convertSpaces:function t(e){return e.replace(d," ")},charMapRegexes:h,hasCorruptCharacters:function t(e){return w.test(e)},defaults:{errorLogging:"json",paragraphLoop:!1,nullGetter:function t(e){return e.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:function t(e){return{get:function t(r){return"."===e?r:r?r[e]:r}}},linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{}},wordToUtf8:function t(e){for(var r,n=h.length-1;n>=0;n--)r=h[n],e=e.replace(r.rstart,r.end);return e},utf8ToWord:function t(e){e=e.toString();for(var r,n=0,o=h.length;n<o;n++)r=h[n],e=e.replace(r.rend,r.start);return e},concatArrays:function t(e){for(var r=[],n=0;n<e.length;n++)for(var o=e[n],i=0,a=o.length;i<a;i++)r.push(o[i]);return r},invertMap:function t(e){return Object.keys(e).reduce(function(t,r){var n=e[r];return t[n]=t[n]||[],t[n].push(r),t},{})},charMap:f,getSingleAttribute:function t(e,r){var n=e.indexOf(" ".concat(r,'="'));if(-1===n)return null;var o=e.substr(n).search(/["']/)+n,i=e.substr(o+1).search(/["']/)+o;return e.substr(o+1,i-o)},setSingleAttribute:function t(e,r,n){if(c[r]?o=c[r]:(o=RegExp("(<.* ".concat(r,'=")([^"]*)(".*)$')),c[r]=o),o.test(e))return e.replace(o,"$1".concat(n,"$3"));var o,i=e.lastIndexOf("/>");return -1===i&&(i=e.lastIndexOf(">")),e.substr(0,i)+" ".concat(r,'="').concat(n,'"')+e.substr(i)},isWhiteSpace:function t(e){return/^[ \n\r\t]+$/.test(e)},stableSort:function t(e,r){return e.map(function(t,e){return{item:t,index:e}}).sort(function(t,e){return r(t.item,e.item)||t.index-e.index}).map(function(t){return t.item})}}},380:function(t,e,r){var n=["modules"];function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function t(e,r){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=o(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==o(e)?e:String(e)}var s=r(557);s.traits=r(505),s.moduleWrapper=r(223);var u=r(919),l=r(257),p=l.throwMultiError,c=l.throwResolveBeforeCompile,f=l.throwRenderInvalidTemplate,h=l.throwRenderTwice,d=r(567),v=r(712),g=r(107),m=r(303),y=s.defaults,x=s.str2xml,$=s.xml2str,w=s.moduleWrapper,b=s.concatArrays,T=s.uniq,P=s.getDuplicates,_=s.stableSort,k=r(257),E=k.XTInternalError,C=k.throwFileTypeNotIdentified,I=k.throwFileTypeNotHandled,O=k.throwApiVersionError,M=[3,38,0];function S(t){t.modules=t.modules.filter(function(e){if(e.supportedFileTypes){if(!Array.isArray(e.supportedFileTypes))throw Error("The supportedFileTypes field of the module must be an array");var r=-1!==e.supportedFileTypes.indexOf(t.fileType);return r||e.on("detached"),r}return!0})}var L=function(){var t,e,r;function a(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.modules,i=void 0===o?[]:o,s=function t(e,r){if(null==e)return{};var n,o,i=function t(e,r){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],r.indexOf(n)>=0||(i[n]=e[n]);return i}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(r,n);if(!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,a),!Array.isArray(i))throw Error("The modules argument of docxtemplater's constructor must be an array");if(this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[g()],this.setOptions(s),i.forEach(function(t){e.attachModule(t)}),arguments.length>0){if(!t||!t.files||"function"!=typeof t.file)throw Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");this.loadZip(t),this.compile(),this.v4Constructor=!0}}return t=a,e=[{key:"verifyApiVersion",value:function t(e){return 3!==(e=e.split(".").map(function(t){return parseInt(t,10)})).length&&O("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==M[0]&&O("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:M,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(M.join("."))}),e[1]>M[1]&&O("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:M,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(M.join("."))}),e[1]===M[1]&&e[2]>M[2]&&O("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:M,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(M.join("."))}),!0}},{key:"setModules",value:function t(e){this.modules.forEach(function(t){t.set(e)})}},{key:"sendEvent",value:function t(e){this.modules.forEach(function(t){t.on(e)})}},{key:"attachModule",value:function t(e){if(this.v4Constructor)throw new E("attachModule() should not be called manually when using the v4 constructor");var r=o(e);if("function"===r)throw new E("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!e||"object"!==r)throw new E("Cannot attachModule with a falsy value");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),!0===e.attached){if("function"==typeof e.clone)e=e.clone();else throw Error('Cannot attach a module that was already attached : "'.concat(e.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'))}e.attached=!0;var n=w(e);return this.modules.push(n),n.on("attached"),this.fileType&&S(this),this}},{key:"setOptions",value:function t(e){var r=this;if(this.v4Constructor)throw Error("setOptions() should not be called manually when using the v4 constructor");if(!e)throw Error("setOptions should be called with an object as first parameter");return this.options={},Object.keys(y).forEach(function(t){var n=y[t];r.options[t]=null!=e[t]?e[t]:r[t]||n,r[t]=r.options[t]}),this.delimiters.start=s.utf8ToWord(this.delimiters.start),this.delimiters.end=s.utf8ToWord(this.delimiters.end),this}},{key:"loadZip",value:function t(e){if(this.v4Constructor)throw Error("loadZip() should not be called manually when using the v4 constructor");if(e.loadAsync)throw new E("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");return this.zip=e,this.updateFileTypeConfig(),this.modules=b([this.fileTypeConfig.baseModules.map(function(t){return t()}),this.modules]),S(this),this}},{key:"precompileFile",value:function t(e){var r=this.createTemplateClass(e);r.preparse(),this.compiled[e]=r}},{key:"compileFile",value:function t(e){this.compiled[e].parse()}},{key:"getScopeManager",value:function t(e,r,n){return this.scopeManagers[e]||(this.scopeManagers[e]=u({tags:n,parser:this.parser,cachedParsers:r.cachedParsers})),this.scopeManagers[e]}},{key:"resolveData",value:function t(e){var r=this,n=[];return Object.keys(this.compiled).length||c(),Promise.resolve(e).then(function(t){return r.setData(t),r.setModules({data:r.data,Lexer:m}),r.mapper=r.modules.reduce(function(t,e){return e.getRenderedMap(t)},{}),Promise.all(Object.keys(r.mapper).map(function(t){var e=r.mapper[t],o=e.from;return Promise.resolve(e.data).then(function(e){var i=r.compiled[o];return i.filePath=t,i.scopeManager=r.getScopeManager(t,i,e),i.resolveTags(e).then(function(t){return i.scopeManager.finishedResolving=!0,t},function(t){Array.prototype.push.apply(n,t)})})})).then(function(t){return 0!==n.length&&(r.options.errorLogging&&d(n,r.options.errorLogging),p(n)),b(t)})})}},{key:"reorderModules",value:function t(){this.modules=_(this.modules,function(t,e){return(e.priority||0)-(t.priority||0)})}},{key:"throwIfDuplicateModules",value:function t(){var e=P(this.modules.map(function(t){return t.name}));if(e.length>0)throw new E('Detected duplicate module "'.concat(e[0],'"'))}},{key:"compile",value:function t(){var e=this;return this.updateFileTypeConfig(),this.throwIfDuplicateModules(),this.reorderModules(),Object.keys(this.compiled).length||(this.options=this.modules.reduce(function(t,r){return r.optionsTransformer(t,e)},this.options),this.options.xmlFileNames=T(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce(function(t,r){var n=e.zip.files[r].asText();return t[r]=x(n),t},{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.precompileFile(t)}),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.compileFile(t)}),this.setModules({compiled:this.compiled}),j(this)),this}},{key:"getRelsTypes",value:function t(){for(var e=this.zip.files["_rels/.rels"],r=e?x(e.asText()):null,n=r?r.getElementsByTagName("Relationship"):[],o={},i=0,a=n.length;i<a;i++){var s=n[i];o[s.getAttribute("Target")]=s.getAttribute("Type")}return o}},{key:"getContentTypes",value:function t(){var e,r=this.zip.files["[Content_Types].xml"],n=r?x(r.asText()):null;return{overrides:n?n.getElementsByTagName("Override"):null,defaults:n?n.getElementsByTagName("Default"):null,contentTypes:r,contentTypeXml:n}}},{key:"updateFileTypeConfig",value:function t(){var e,r=this;this.zip.files.mimetype&&(e="odt"),this.relsTypes=this.getRelsTypes();var n=this.getContentTypes(),o=n.overrides,i=n.defaults,u=n.contentTypes,l=n.contentTypeXml;return l&&(this.filesContentTypes=v(o,i,this.zip),this.invertedContentTypes=s.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.modules.forEach(function(t){e=t.getFileType({zip:r.zip,contentTypes:u,contentTypeXml:l,overrides:o,defaults:i,doc:r})||e}),"odt"===e&&I(e),e||C(),this.fileType=e,S(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig||a.FileTypeConfig[this.fileType](),this}},{key:"renderAsync",value:function t(e){var r=this;return this.resolveData(e).then(function(){return r.render()})}},{key:"render",value:function t(e){var r=this;return this.rendered&&h(),this.rendered=!0,this.compile(),this.errors.length>0&&f(),e&&this.setData(e),this.setModules({data:this.data,Lexer:m}),this.mapper=this.mapper||this.modules.reduce(function(t,e){return e.getRenderedMap(t)},{}),Object.keys(this.mapper).forEach(function(t){var e=r.mapper[t],n=e.from,o=e.data,i=r.compiled[n];i.scopeManager=r.getScopeManager(t,i,o),i.render(t),r.zip.file(t,i.content,{createFolders:!0})}),j(this),this.sendEvent("syncing-zip"),this.syncZip(),this}},{key:"syncZip",value:function t(){var e=this;Object.keys(this.xmlDocuments).forEach(function(t){e.zip.remove(t);var r=$(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})})}},{key:"setData",value:function t(e){return this.data=e,this}},{key:"getZip",value:function t(){return this.zip}},{key:"createTemplateClass",value:function t(e){var r=this.zip.files[e].asText();return this.createTemplateClassFromContent(r,e)}},{key:"createTemplateClassFromContent",value:function t(e,r){var n=this,o={filePath:r,contentType:this.filesContentTypes[r],relsType:this.relsTypes[r]};return Object.keys(y).concat(["filesContentTypes","fileTypeConfig","fileType","modules"]).forEach(function(t){o[t]=n[t]}),new a.XmlTemplater(e,o)}},{key:"getFullText",value:function t(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function t(){var e=this;return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.targets.forEach(function(t){e.templatedFiles.push(t)}),this.templatedFiles=T(this.templatedFiles),this.templatedFiles}}],i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}();function j(t){var e=t.compiled;t.errors=b(Object.keys(e).map(function(t){return e[t].allErrors})),0!==t.errors.length&&(t.options.errorLogging&&d(t.errors,t.options.errorLogging),p(t.errors))}L.DocUtils=s,L.Errors=r(257),L.XmlTemplater=r(827),L.FileTypeConfig=r(952),L.XmlMatcher=r(465),t.exports=L,t.exports.default=L},567:function(t){function e(t,e){return e instanceof Error?Object.getOwnPropertyNames(e).concat("stack").reduce(function(t,r){return t[r]=e[r],"stack"===r&&(t[r]=e[r].toString()),t},{}):e}t.exports=function t(r,n){if(console.log(JSON.stringify({error:r},e,"json"===n?2:null)),r.properties&&r.properties.errors instanceof Array){var o=r.properties.errors.map(function(t){return t.properties.explanation}).join("\n");console.log("errorMessages",o)}}},257:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t,e,r){var o,i;return(e=(o=e,i=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(o,"string"),"symbol"==n(i)?i:String(i)))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r(287),s=a.last,u=a.first;function l(t){this.name="GenericError",this.message=t,this.stack=Error(t).stack}function p(t){this.name="TemplateError",this.message=t,this.stack=Error(t).stack}function c(t){this.name="RenderingError",this.message=t,this.stack=Error(t).stack}function f(t){this.name="ScopeParserError",this.message=t,this.stack=Error(t).stack}function h(t){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=t,this.stack=Error(t).stack}function d(t){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=t,this.stack=Error(t).stack}l.prototype=Error.prototype,p.prototype=new l,c.prototype=new l,f.prototype=new l,h.prototype=new l,d.prototype=new l,t.exports={XTError:l,XTTemplateError:p,XTInternalError:h,XTScopeParserError:f,XTAPIVersionError:d,RenderingError:c,XTRenderingError:c,getClosingTagNotMatchOpeningTag:function t(e){var r=e.tags,n=new p("Closing tag does not match opening tag");return n.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(r[0].value,'" is closed by the tag "').concat(r[1].value,'"'),openingtag:u(r).value,offset:[u(r).offset,s(r).offset],closingtag:s(r).value},n},getLoopPositionProducesInvalidXMLError:function t(e){var r=e.tag,n=e.offset,o=new p('The position of the loop tags "'.concat(r,'" would produce invalid XML'));return o.properties={xtag:r,id:"loop_position_invalid",explanation:'The tags "'.concat(r,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:n},o},getScopeCompilationError:function t(e){var r=e.tag,n=e.rootError,o=e.offset,i=new f("Scope parser compilation failed");return i.properties={id:"scopeparser_compilation_failed",offset:o,xtag:r,explanation:'The scope parser for the tag "'.concat(r,'" failed to compile'),rootError:n},i},getScopeParserExecutionError:function t(e){var r=e.tag,n=e.scope,o=e.error,i=e.offset,a=new f("Scope parser execution failed");return a.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(r," failed to execute"),scope:n,offset:i,xtag:r,rootError:o},a},getUnclosedTagException:function t(e){var r=new p("Unclosed tag");return r.properties={xtag:u(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},r},getUnopenedTagException:function t(e){var r=new p("Unopened tag");return r.properties={xtag:s(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},r},getUnmatchedLoopException:function t(e){var r=e.location,n=e.offset,o=e.square,i="start"===r?"unclosed":"unopened",a=new p("".concat("start"===r?"Unclosed":"Unopened"," loop")),s=e.value;return a.properties={id:"".concat(i,"_loop"),explanation:'The loop with tag "'.concat(s,'" is ').concat(i),xtag:s,offset:n},o&&(a.properties.square=o),a},getDuplicateCloseTagException:function t(e){var r=new p("Duplicate close tag, expected one close tag");return r.properties={xtag:u(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},r},getDuplicateOpenTagException:function t(e){var r=new p("Duplicate open tag, expected one open tag");return r.properties={xtag:u(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},r},getCorruptCharactersException:function t(e){var r=e.tag,n=e.value,o=e.offset,i=new c("There are some XML corrupt characters");return i.properties={id:"invalid_xml_characters",xtag:r,value:n,offset:o,explanation:"There are some corrupt characters for the field ".concat(r)},i},getInvalidRawXMLValueException:function t(e){var r=e.tag,n=e.value,o=e.offset,i=new c("Non string values are not allowed for rawXML tags");return i.properties={id:"invalid_raw_xml_value",xtag:r,value:n,offset:o,explanation:"The value of the raw tag : '".concat(r,"' is not a string")},i},getUnbalancedLoopException:function t(e,r){var n=new p("Unbalanced loop tag"),o=r[0].part.value,i=r[1].part.value,a=e[0].part.value,s=e[1].part.value;return n.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(o,"}{/").concat(i,"}{#").concat(a,"}{/").concat(s,"}"),offset:[r[0].part.offset,e[1].part.offset],lastPair:{left:r[0].part.value,right:r[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},n},throwApiVersionError:function t(e,r){var n=new d(e);throw n.properties=function t(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({id:"api_version_error"},r),n},throwFileTypeNotHandled:function t(e){var r=new h('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw r.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},r},throwFileTypeNotIdentified:function t(){var e=new h("The filetype for this file could not be identified, is this file corrupted ?");throw e.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ?"},e},throwMalformedXml:function t(){var e=new h("Malformed xml");throw e.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},e},throwMultiError:function t(e){var r=new p("Multi error");throw r.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},r},throwExpandNotFound:function t(e){var r=e.part,n=r.value,o=r.offset,i=e.id,a=e.message,s=e.part,u=e.explanation,l=void 0===u?'The tag "'.concat(n,'" is not inside a paragraph'):u;"function"==typeof l&&(l=l(s));var c=new p(void 0===a?"Raw tag not in paragraph":a);throw c.properties={id:void 0===i?"raw_tag_outerxml_invalid":i,explanation:l,rootError:e.rootError,xtag:n,offset:o,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},c},throwRawTagShouldBeOnlyTextInParagraph:function t(e){var r=new p("Raw tag should be the only text in paragraph"),n=e.part.value;throw r.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(n,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:n,offset:e.part.offset,paragraphParts:e.paragraphParts},r},throwUnimplementedTagType:function t(e,r){var n='Unimplemented tag type "'.concat(e.type,'"');e.module&&(n+=' "'.concat(e.module,'"'));var o=new p(n);throw o.properties={part:e,index:r,id:"unimplemented_tag_type"},o},throwXmlTagNotFound:function t(e){var r=new p('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),n=e.parsed[e.index];throw r.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:n.offset,part:n,parsed:e.parsed,index:e.index,element:e.element},r},throwXmlInvalid:function t(e,r){var n=new p("An XML file has invalid xml");throw n.properties={id:"file_has_invalid_xml",content:e,offset:r,explanation:"The docx contains invalid XML, it is most likely corrupt"},n},throwResolveBeforeCompile:function t(){var e=new h("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},e},throwRenderInvalidTemplate:function t(){var e=new h("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},e},throwRenderTwice:function t(){var e=new h("You should not call .render twice on the same docxtemplater instance");throw e.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},e}}},952:function(t,e,r){var n=r(19),o=r(95),i=r(182),a=r(999),s=r(163);t.exports={docx:function t(){return{getTemplatedFiles:function t(){return[]},textPath:function t(e){return e.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","w:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[n,o,a,i,s],tagShouldContain:[{tag:"w:tbl",shouldContain:["w:tr"],drop:!0},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"}]}},pptx:function t(){return{getTemplatedFiles:function t(){return[]},textPath:function t(e){return e.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[n,a,i,s],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],drop:!0},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}},330:function(t){var e=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml"],r={main:e,docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"].concat(e,["application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"]),pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"]};t.exports=r},709:function(t){t.exports=function t(e,r){if(null==e.lIndex)return null;var n=r.scopeManager.scopePathItem;return e.parentPart&&(n=n.slice(0,n.length-1)),r.filePath+"@"+e.lIndex.toString()+"-"+n.join("-")}},127:function(t,e,r){var n=r(557),o=n.startsWith,i=n.endsWith,a=n.isStarting,s=n.isEnding,u=n.isWhiteSpace,l=r(330);t.exports=function t(e,r){var n=r.fileTypeConfig.tagShouldContain||[],p="",c=-1;-1!==l.docx.indexOf(r.contentType)&&(e=function t(e){for(var r="",n=0,a=e.length;n<a;n++){var s=e[n];!u(s)&&(!i(r,"</w:tbl>")||o(s,"<w:p")||o(s,"<w:tbl")||o(s,"<w:sectPr")||(s="<w:p/>".concat(s)),r=s,e[n]=s)}return e}(e));for(var f=-1,h=0,d=e.length;h<d;h++)for(var v=e[h],g=0,m=n.length;g<m;g++){var y=n[g],x=y.tag,$=y.shouldContain,w=y.value,b=y.drop;if(c===g){if(s(v,x)){if(c=-1,b)for(var T=f;T<=h;T++)e[T]="";else{for(var P=f;P<h;P++)e[P]="";e[h]=p+w+v}break}p+=v;for(var _=0,k=$.length;_<k;_++)if(a(v,$[_])){c=-1;break}break}if(-1===c&&a(v,x)&&-1===v.substr(1).indexOf("<")){if("/"===v[v.length-2]){e[h]="";break}f=h,c=g,p=v;break}}return e}},303:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return function t(e){if(Array.isArray(e))return e}(t)||function t(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,s,u=[],l=!0,p=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(u.push(o.value),u.length!==r);l=!0);}catch(c){p=!0,i=c}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(p)throw i}}return u}}(t,e)||function t(e,r){if(e){if("string"==typeof e)return i(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,r)}}(t,e)||function t(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){u(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function u(t,e,r){var o,i;return(e=(o=e,i=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(o,"string"),"symbol"==n(i)?i:String(i)))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=r(257),p=l.getUnclosedTagException,c=l.getUnopenedTagException,f=l.getDuplicateOpenTagException,h=l.getDuplicateCloseTagException,d=l.throwMalformedXml,v=l.throwXmlInvalid,g=l.XTTemplateError,m=r(557),y=m.isTextStart,x=m.isTextEnd,$=m.wordToUtf8;function w(t,e){return t[0]<=e.offset&&e.offset<t[1]}function b(t){var e="",r=1,n=t.indexOf(" ");return"/"===t[t.length-2]?(e="selfclosing",-1===n&&(n=t.length-2)):"/"===t[1]?(r=2,e="end",-1===n&&(n=t.length-1)):(e="start",-1===n&&(n=t.length-1)),{tag:t.slice(r,n),position:e}}function T(t,e){return -1===t&&-1===e?0:t===e?1:-1===t||-1===e?e<t?2:3:t<e?2:3}function P(t){var e=t.split(" ");if(2!==e.length){var r=new g("New Delimiters cannot be parsed");throw r.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},r}var n=o(e,2),i=n[0],a=n[1];if(0===i.length||0===a.length){var s=new g("New Delimiters cannot be parsed");throw s.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},s}return[i,a]}function _(t,e,r){var n=t.map(function(t){return t.value}).join(""),i=function t(e,r){for(var n=[],i=r.start,a=r.end,s=-1,u=!1;;){var l=e.indexOf(i,s+1),p=e.indexOf(a,s+1),c=null,f=void 0,h=T(l,p);switch(1===h&&(h=u?3:2),h){case 0:return n;case 3:u=!1,s=p,c="end",f=a.length;break;case 2:u=!0,s=l,c="start",f=i.length}if(2===h&&"="===e[s+i.length]){n.push({offset:l,position:"start",length:i.length,changedelimiter:!0});var d=e.indexOf("=",s+i.length+1),v=e.indexOf(a,d+1);n.push({offset:v,position:"end",length:a.length,changedelimiter:!0});var g=P(e.substr(s+i.length+1,d-s-i.length-1)),m=o(g,2);i=m[0],a=m[1],s=v;continue}n.push({offset:s,position:c,length:f})}}(n,e),a=0,u=t.map(function(t){return{offset:(a+=t.value.length)-t.value.length,lIndex:t.lIndex}}),l=function t(e,r,n){var o,i=[],a=!1,u={offset:0},l=e.reduce(function(t,e){var l=e.position,d=e.offset,v=u.offset,g=u.length;return(o=r.substr(v,d-v),a&&"start"===l)?v+g===d?(o=r.substr(v,d-v+g+4),i.push(f({xtag:o,offset:v})),u=e,t.push(s(s({},e),{},{error:!0})),t):(i.push(p({xtag:$(o),offset:v})),u=e,t.push(s(s({},e),{},{error:!0})),t):a||"end"!==l?(a=!a,u=e,t.push(e),t):n.allowUnopenedTag?t:v+g===d?(o=r.substr(v-4,d-v+g+4),i.push(h({xtag:o,offset:v})),u=e,t.push(s(s({},e),{},{error:!0})),t):(i.push(c({xtag:o,offset:d})),u=e,t.push(s(s({},e),{},{error:!0})),t)},[]);if(a){var d=u.offset;o=r.substr(d,r.length-d),i.push(p({xtag:$(o),offset:d}))}return{delimiterWithErrors:l,errors:i}}(i,n,r),d=l.delimiterWithErrors,v=l.errors,g=0,m=0;return{parsed:u.map(function(e,r){for(var n=e.offset,o=[n,n+t[r].value.length],i=t[r].value,a=[];m<d.length&&w(o,d[m]);)a.push(d[m]),m++;var s=[],u=0;g>0&&(u=g,g=0),a.forEach(function(t){var e=i.substr(u,t.offset-n-u);if(t.changedelimiter){"start"===t.position?e.length>0&&s.push({type:"content",value:e}):u=t.offset-n+t.length;return}e.length>0&&(s.push({type:"content",value:e}),u+=e.length);var r={type:"delimiter",position:t.position,offset:u+n};s.push(r),u=t.offset-n+t.length}),g=u-i.length;var l=i.substr(u);return l.length>0&&s.push({type:"content",value:l}),s},this),errors:v}}function k(t){return"content"===t.type&&"insidetag"===t.position}t.exports={parseDelimiters:_,parse:function t(e,r,n,o){!function t(e,r){var n=!1;e.forEach(function(t){var e,o;n=(e=t,o=n,y(e)?(o&&d(),!0):x(e)?(o||d(),!1):o),"content"===t.type&&(t.position=n?"insidetag":"outsidetag"),"text"!==r&&k(t)&&(t.value=t.value.replace(/>/g,"&gt;"))})}(e,o);var i,a=_((i=e).filter(k),r,n),s=a.parsed,u=a.errors,l=[],p=0,c=0;return e.forEach(function(t){k(t)?(Array.prototype.push.apply(l,s[p].map(function(t){return"content"===t.type&&(t.position="insidetag"),t.lIndex=c++,t})),p++):(t.lIndex=c++,l.push(t))}),{errors:u,lexed:l}},xmlparse:function t(e,r){var n=function t(e,r,n){for(var o=0,i=e.length,a={},s=0,u=r.length;s<u;s++)a[r[s]]=!0;for(var l=0,p=n.length;l<p;l++)a[n[l]]=!1;for(var c=[];o<i&&-1!==(o=e.indexOf("<",o));){var f=o,h=e.indexOf("<",o+1);(-1===(o=e.indexOf(">",o))||-1!==h&&o>h)&&v(e,f);var d=e.slice(f,o+1),g=b(d),m=g.tag,y=g.position,x=a[m];null!=x&&c.push({type:"tag",position:y,text:x,offset:f,value:d,tag:m})}return c}(e,r.text,r.other),o=0,i=n.reduce(function(t,r){var n=e.substr(o,r.offset-o);return n.length>0&&t.push({type:"content",value:n}),o=r.offset+r.value.length,delete r.offset,t.push(r),t},[]),a=e.substr(o);return a.length>0&&i.push({type:"content",value:a}),i}}},509:function(t){function e(t,e){for(var r=-1,n=0,o=t.length;n<o;n++)!(e[n]>=t[n].length)&&(-1===r||t[n][e[n]].offset<t[r][e[r]].offset)&&(r=n);return r}t.exports=function(t){var r=t.reduce(function(t,e){return t+e.length},0);t=t.filter(function(t){return t.length>0});for(var n=Array(r),o=t.map(function(){return 0}),i=0;i<r;i++){var a=e(t,o);n[i]=t[a][o[a]],o[a]++}return n}},223:function(t,e,r){var n=r(257).XTInternalError;function o(){}function i(t){return t}t.exports=function(t){var e={set:o,matchers:function t(){return[]},parse:o,render:o,getTraits:o,getFileType:o,nullGetter:o,optionsTransformer:i,postrender:i,errorsTransformer:i,getRenderedMap:i,preparse:i,postparse:i,on:o,resolve:o,preResolve:o};if(Object.keys(e).every(function(e){return!t[e]})){var r=new n("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw r.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},r}return Object.keys(e).forEach(function(r){t[r]=t[r]||e[r]}),t}},107:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a,s=r(223),u=r(330),l=r(731),p=l.settingsContentType,c=l.coreContentType,f=[p,c,l.appContentType,l.customContentType],h=function(){var t,e,r;function n(){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.name="Common"}return t=n,e=[{key:"getFileType",value:function t(e){var r,n=e.doc,o=n.invertedContentTypes;if(o){for(var i=0,a=f.length;i<a;i++){var s=f[i];o[s]&&Array.prototype.push.apply(n.targets,o[s])}for(var l=["docx","pptx"],p=0,c=l.length;p<c;p++){for(var h=u[l[p]],d=0,v=h.length;d<v;d++){var g=h[d];if(o[g])for(var m=0,y=o[g].length;m<y;m++){var x=o[g][m];(!n.relsTypes[x]||-1!==["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(n.relsTypes[x]))&&(r=l[p],(-1!==u.main.indexOf(g)||g===u.pptx[0])&&(n.textTarget||(n.textTarget=x)),n.targets.push(x))}}if(r)break}return r}}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(){return s(new h)}},999:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a=r(509),s=r(557),u=s.getLeft,l=s.getRight,p=r(223),c=r(505).getExpandToDefault,f=r(257),h=f.getUnmatchedLoopException,d=f.getClosingTagNotMatchOpeningTag,v=f.getUnbalancedLoopException;function g(t){switch(t.location){case"start":return 1;case"end":return -1}}function m(t,e){return null!=t&&null!=e&&("start"===t.part.location&&"end"===e.part.location&&t.part.value===e.part.value||""===e.part.value)}function y(t){for(var e=0,r=[];e<t.length;){var n=t[e].part;if("end"===n.location){if(0===e)return t.splice(0,1),r.push(h(n)),{traits:t,errors:r};var o=e,i=e-1,a=1;if(m(t[i],t[o]))return t.splice(o,1),t.splice(i,1),{errors:r,traits:t};for(;a<50;){var s=t[i-a],u=t[o+a];if(m(s,t[o]))return t.splice(o,1),t.splice(i-a,1),{errors:r,traits:t};if(m(t[i],u))return t.splice(o+a,1),t.splice(i,1),{errors:r,traits:t};a++}return r.push(d({tags:[t[i].part,t[o].part]})),t.splice(o,1),t.splice(i,1),{traits:t,errors:r}}e++}return t.forEach(function(t){var e=t.part;r.push(h(e))}),{traits:[],errors:r}}var x=function(){var t,e,r;function n(){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.name="ExpandPairTrait"}return t=n,e=[{key:"optionsTransformer",value:function t(e,r){return this.expandTags=r.fileTypeConfig.expandTags.concat(r.options.paragraphLoop?r.fileTypeConfig.onParagraphLoop:[]),e}},{key:"postparse",value:function t(e,r){var n,o=this,i=r.getTraits,s=r.postparse,p=r.fileType,f=i("expandPair",e),h=function t(e){for(var r={},n=[],o=[],i=[],a=0;a<e.length;a++)i.push(e[a]);for(;i.length>0;){var s=y(i);n=n.concat(s.errors),i=s.traits}if(n.length>0)return{pairs:o,errors:n};for(var u=0,l=0;l<e.length;l++){var p=e[l],c=g(p.part);if(u+=c,1===c)r[u]=p;else{var f=r[u+1];0===u&&(o=o.concat([[f,p]]))}u=u>=0?u:0}return{pairs:o,errors:n}}(f=a(f=f.map(function(t){return t||[]}))),d=h.pairs,m=h.errors,x=0,$=null,w=d.map(function(t){var r,n,i=t[0].part.expandTo;if("auto"===i&&"text"!==p){var a=c(e,t,o.expandTags);a.error&&m.push(a.error),i=a.value}if(!i||"text"===p){var s=t[0].offset,f=t[1].offset;return s<x&&m.push(v(t,$)),$=t,x=f,[s,f]}try{r=u(e,i,t[0].offset)}catch(h){m.push(h)}try{n=l(e,i,t[1].offset)}catch(d){m.push(d)}return r<x&&m.push(v(t,$)),x=n,$=t,[r,n]});if(m.length>0)return{postparsed:e,errors:m};var b=0;return{postparsed:e.reduce(function(t,r,o){var i=b<d.length&&w[b][0]<=o&&o<=w[b][1],a=d[b],u=w[b];if(!i)return t.push(r),t;if(u[0]===o&&(n=[]),a[0].offset!==o&&a[1].offset!==o&&n.push(r),u[1]===o){var l=e[a[0].offset];l.subparsed=s(n,{basePart:l}),l.endLindex=a[1].part.lIndex,delete l.location,delete l.expandTo,t.push(l),b++}return t},[]),errors:m}}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(){return p(new x)}},19:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function a(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var c=r(557),f=c.chunkBy,h=c.last,d=c.isParagraphStart,v=c.isModule,g=c.isParagraphEnd,m=c.isContent,y=c.startsWith,x=c.isTagEnd,$=c.isTagStart,w=c.getSingleAttribute,b=c.setSingleAttribute,T=r(330),P=r(223),_="loop";function k(t){var e=function t(e){for(var r=0,n=e.length;r<n;r++)if("content"!==e[r].type)return e[r];return null}(t.subparsed);return null!=e&&"w:t"!==e.tag}function E(t){var e;return(e=t).some(function(t){return m(t)})?0:t.length}function C(t){var e=t.parts.length-1;"</w:p>"===t.parts[e]?t.parts.splice(e,0,'<w:r><w:br w:type="page"/></w:r>'):t.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function I(t){return t.some(function(t){return"w:br"===t.tag&&-1!==t.value.indexOf('w:type="page"')})}function O(t){return t.some(function(t){return"w:drawing"===t.tag})}var M=function(){var t,e,r;function n(){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}}return t=n,e=[{key:"optionsTransformer",value:function t(e,r){return this.docxtemplater=r,e}},{key:"preparse",value:function t(e,r){var n,o,i,a=r.contentType;-1!==T.main.indexOf(a)&&(this.sects=(o=!1,i=[],(n=e).forEach(function(t){$("w:sectPr",t)&&(i.push([]),o=!0),o&&i[i.length-1].push(t),x("w:sectPr",t)&&(o=!1)}),i))}},{key:"matchers",value:function t(){var e=_;return[[this.prefix.start,e,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,e,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,e,{location:"end"}],[this.prefix.dash,e,function(t){var e,r,n=function t(e){if(Array.isArray(e))return e}(e=t)||function t(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,s,u=[],l=!0,p=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(u.push(o.value),u.length!==r);l=!0);}catch(c){p=!0,i=c}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(p)throw i}}return u}}(e,3)||s(e,3)||function t(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return{location:"start",inverted:!1,expandTo:n[1],value:n[2]}}]]}},{key:"getTraits",value:function t(e,r){if("expandPair"===e)return r.reduce(function(t,e,r){return v(e,_)&&null==e.subparsed&&t.push({part:e,offset:r}),t},[])}},{key:"postparse",value:function t(e,r){var n,o=r.basePart;if(o&&"docx"===this.docxtemplater.fileType&&e.length>0){o.sectPrCount=(i=e,a=!1,s=0,i.forEach(function(t){$("w:sectPr",t)&&(a=!0),a&&("w:headerReference"===t.tag||"w:footerReference"===t.tag)&&(s++,a=!1),x("w:sectPr",t)&&(a=!1)}),s),this.totalSectPr+=o.sectPrCount;var i,a,s,u=this.sects;u.some(function(t,r){var n,i;return o.lIndex<t[0].lIndex?(r+1<u.length&&(n=u[r+1]).some(function(t){return $("w:type",t)&&-1!==t.value.indexOf("continuous")})&&(o.addContinuousType=!0),!0):e[0].lIndex<t[0].lIndex&&t[0].lIndex<o.lIndex?((i=u[r]).some(function(t){return $("w:type",t)&&-1!==t.value.indexOf('w:val="nextPage"')})&&(o.addNextPage={index:r}),!0):void 0}),o.lastParagrapSectPr=function t(e){for(var r=[],n=!1,o=e.length-1;o>=0;o--){var i=e[o];if(x("w:sectPr",i)&&(n=!0),$("w:sectPr",i)&&(r.unshift(i.value),n=!1),n&&r.unshift(i.value),d(i)){if(r.length>0)return r.join("");break}}return""}(e)}if(!o||"auto"!==o.expandTo||o.module!==_||!((n=e).length&&d(n[0])&&g(h(n))))return e;o.paragraphLoop=!0;var l=0,p=f(e,function(t){return d(t)&&1==++l?"start":g(t)&&0==--l?"end":null}),c=p[0],v=h(p),m=E(c),y=E(v);return o.hasPageBreakBeginning=I(c),o.hasPageBreak=I(v),O(c)&&(m=0),O(v)&&(y=0),e.slice(m,e.length-y)}},{key:"resolve",value:function t(e,r){if(!v(e,_))return null;var n=r.scopeManager,o=n.getValueAsync(e.value,{part:e}),a=[];function l(t,o,s){var u=n.createSubScopeManager(t,e.value,o,e,s);a.push(r.resolve(i(i({},r),{},{compiled:e.subparsed,tags:{},scopeManager:u})))}var p=[];return o.then(function(t){return new Promise(function(e){t instanceof Array?Promise.all(t).then(e):e(t)}).then(function(t){return n.loopOverValue(t,l,e.inverted),Promise.all(a).then(function(t){return t.map(function(t){var e,r=t.resolved,n=t.errors;return p.push.apply(p,function t(e){if(Array.isArray(e))return u(e)}(e=n)||function t(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function t(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r})}).then(function(t){if(p.length>0)throw p;return t})})})}},{key:"render",value:function t(e,r){if("p:xfrm"===e.tag&&(this.inXfrm="start"===e.position),"a:ext"===e.tag&&this.inXfrm)return this.lastExt=e,e;if(!v(e,_))return null;var n,o=[],a=[],s=0,u=this,l=e.subparsed[0],p=0;(null==l?void 0:l.tag)==="a:tr"&&(p=+w(l.value,"h")),s-=p;var c=0,f=k(e);if(!1===r.scopeManager.loopOver(e.value,function t(n,l,h){s+=p;var d,v,g,m,x,T,P=r.scopeManager.createSubScopeManager(n,e.value,l,e,h);e.subparsed.forEach(function(t){if($("a16:rowId",t)){var e=+w(t.value,"val")+c;c=1,t.value=b(t.value,"val",e)}});var _=r.render(i(i({},r),{},{compiled:e.subparsed,tags:{},scopeManager:P}));(e.hasPageBreak&&l===h-1&&f&&C(_),P.scopePathItem.some(function(t){return 0!==t}))?(1===e.sectPrCount&&(_.parts=(d=_.parts).filter(function(t){return!y(t,"<w:headerReference")&&!y(t,"<w:footerReference")})),e.addContinuousType&&(_.parts=(v=_.parts,g=!1,m=!1,v.reduce(function(t,e){return!1===g&&y(e,"<w:sectPr")&&(m=!0),m&&(y(e,"<w:type")&&(g=!0),!1===g&&y(e,"</w:sectPr")&&t.push('<w:type w:val="continuous"/>')),t.push(e),t},[])))):e.addNextPage&&(_.parts=(x=_.parts,T=u.sects[e.addNextPage.index],["<w:p><w:pPr>".concat(T.map(function(t){return t.value}).join(""),"</w:pPr></w:p>")].concat(x))),e.addNextPage&&C(_),e.hasPageBreakBeginning&&f&&function t(e){e.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(_);for(var k=0,E=_.parts.length;k<E;k++)o.push(_.parts[k]);Array.prototype.push.apply(a,_.errors)},e.inverted,{part:e}))return e.lastParagrapSectPr?e.paragraphLoop?{value:"<w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:((n=e).hasPageBreak&&k(n)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':"")||"",errors:a};if(0!==s){var h=+w(this.lastExt.value,"cy");this.lastExt.value=b(this.lastExt.value,"cy",h+s)}return{value:r.joinUncorrupt(o,i(i({},r),{},{basePart:e})),errors:a}}}],l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(){return P(new M)}},182:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a=r(505),s=r(557).isContent,u=r(257),l=u.throwRawTagShouldBeOnlyTextInParagraph,p=u.getInvalidRawXMLValueException,c="rawxml",f=r(223);function h(t){var e=t.part,r=t.left,n=t.right,o=t.postparsed,i=t.index,a=o.slice(r+1,n);return a.forEach(function(t,n){n!==i-r-1&&s(t)&&l({paragraphParts:a,part:e})}),e}var d=function(){var t,e,r;function n(){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.name="RawXmlModule",this.prefix="@"}return t=n,e=[{key:"optionsTransformer",value:function t(e,r){return this.fileTypeConfig=r.fileTypeConfig,e}},{key:"matchers",value:function t(){return[[this.prefix,c]]}},{key:"postparse",value:function t(e){return a.expandToOne(e,{moduleName:c,getInner:h,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function t(e){return'The tag "'.concat(e.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function t(e,r){if(e.module!==c)return null;var n,o=[];try{n=r.scopeManager.getValue(e.value,{part:e}),null==n&&(n=r.nullGetter(e))}catch(i){return o.push(i),{errors:o}}return"string"==typeof(n=n||"")?{value:n}:{errors:[p({tag:e.value,value:n,offset:e.offset})]}}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(){return f(new d)}},163:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a=r(223),s=r(257).getScopeCompilationError,u=r(557),l=u.utf8ToWord,p=u.hasCorruptCharacters,c=r(257).getCorruptCharactersException,f=r(731),h=f.settingsContentType,d=f.coreContentType,v=f.appContentType,g=f.customContentType,m={docx:"w",pptx:"a"},y=function(){var t,e,r;function n(){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.name="Render",this.recordRun=!1,this.recordedRun=[]}return t=n,e=[{key:"optionsTransformer",value:function t(e,r){return this.parser=r.parser,this.fileType=r.fileType,e}},{key:"set",value:function t(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function t(e){var r=this;return Object.keys(this.compiled).reduce(function(t,e){return t[e]={from:e,data:r.data},t},e)}},{key:"postparse",value:function t(e,r){var n=this,o=[];return e.forEach(function(t){if("placeholder"===t.type){var e=t.value;try{r.cachedParsers[t.lIndex]=n.parser(e,{tag:t})}catch(i){o.push(s({tag:e,rootError:i,offset:t.offset}))}}}),{postparsed:e,errors:o}}},{key:"render",value:function t(e,r){var n,o=r.contentType,i=r.scopeManager,a=r.linebreaks,s=r.nullGetter,u=r.fileType;if(a&&-1!==[h,d,v,g].indexOf(o)&&(a=!1),a&&this.recordRuns(e),"placeholder"===e.type&&!e.module){try{n=i.getValue(e.value,{part:e})}catch(f){return{errors:[f]}}return(null==n&&(n=s(e)),p(n))?{errors:[c({tag:e.value,value:n,offset:e.offset})]}:"text"===u?{value:n}:{value:a&&"string"==typeof n?this.renderLineBreaks(n):l(n)}}}},{key:"recordRuns",value:function t(e){e.tag==="".concat(m[this.fileType],":r")?this.recordedRun=[]:e.tag==="".concat(m[this.fileType],":rPr")?("start"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),("end"===e.position||"selfclosing"===e.position)&&(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:"renderLineBreaks",value:function t(e){var r=this,n=m[this.fileType],o="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",i=e.split("\n"),a=this.recordedRun.join("");return i.map(function(t){return l(t)}).reduce(function(t,e,s){return t.push(e),s<i.length-1&&t.push("</".concat(n,":t></").concat(n,":r>").concat(o,"<").concat(n,":r>").concat(a,"<").concat(n,":t").concat("docx"===r.fileType?' xml:space="preserve"':"",">")),t},[])}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(){return a(new y)}},95:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a=r(223),s=r(557),u=s.isTextStart,l=s.isTextEnd,p=s.endsWith,c=s.startsWith,f='<w:t xml:space="preserve">',h=f.length,d="</w:t>",v=d.length;function g(t,e){var r=t[e].value;return"</w:t>"===t[e+1].value||-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var m=function(){var t,e,r;function n(){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.name="SpacePreserveModule"}return t=n,e=[{key:"postparse",value:function t(e,r){var n=[],o=!1,i=0,a=0,s=e.reduce(function(t,e){var s,p,c,f,h;return(u(s=e)&&"w:t"===s.tag&&(o=!0,a=n.length),o)?(n.push(e),p=r,c=n,p&&p.basePart&&c.length>1&&(i=r.basePart.endLindex,n[0].value=g(n,0)),f=e,h=n,"placeholder"===f.type&&h.length>1&&(n[a].value=g(n,a),i=e.endLindex),l(e)&&e.lIndex>i&&(0!==i&&(n[a].value=g(n,a)),Array.prototype.push.apply(t,n),n=[],o=!1,i=0,a=0),t):(t.push(e),t)},[]);return Array.prototype.push.apply(s,n),s}},{key:"postrender",value:function t(e){for(var r="",n=0,o=0,i=e.length;o<i;o++){var a=o,s=e[o];""!==s&&(p(r,f)&&c(s,d)&&(e[n]=r.substr(0,r.length-h)+"<w:t/>",s=s.substr(v)),r=s,n=a,e[o]=s)}return e}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(){return a(new m)}},190:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function a(t,e,r){var o,i;return(e=(o=e,i=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(o,"string"),"symbol"==n(i)?i:String(i)))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){return function t(e){if(Array.isArray(e))return e}(t)||function t(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,s,u=[],l=!0,p=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(u.push(o.value),u.length!==r);l=!0);}catch(c){p=!0,i=c}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(p)throw i}}return u}}(t,e)||l(t,e)||function t(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){return function t(e){if(Array.isArray(e))return p(e)}(t)||function t(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||l(t)||function t(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var c=r(557).wordToUtf8,f=r(3),h=f.match,d=f.getValue,v=f.getValues;t.exports={preparse:function t(e,r,n){var o,i;return{preparsed:(o=e,i=n,r.forEach(function(t){t.preparse(o,i)}))}},parse:function t(e,r,n){var o,a=!1,l="",p=[],f=n.fileTypeConfig.droppedTagsInsidePlaceholder||[];return e.reduce(function t(e,g){return"delimiter"===g.type?(a="start"===g.position,"end"===g.position&&(n.parse=function(t){return function t(e,r){var n,o=r.modules,a=r.startOffset,l=r.lIndex;r.offset=a,r.match=h,r.getValue=d,r.getValues=v;var p=function t(e,r,n){for(var o=[],a=0,u=e.length;a<u;a++){var l=e[a],p=s(l,2),c=p[0],f=p[1],h=l[2]||{};if(n.match(c,r)){var d=n.getValues(c,r);if("function"==typeof h&&(h=h(d)),!h.value){var v=s(d,2);h.value=v[1]}o.push(i({type:"placeholder",prefix:c,module:f,onMatch:h.onMatch,priority:h.priority},h))}}return o}(function t(e,r){for(var n=[],o=0,i=e.length;o<i;o++){var a=e[o];if(a.matchers){var s=a.matchers(r);if(!(s instanceof Array))throw Error("module matcher returns a non array");n.push.apply(n,u(s))}}return n}(o,r),e,r);if(p.length>0){var c=null;return p.forEach(function(t){t.priority=t.priority||-t.value.length,(!c||t.priority>c.priority)&&(c=t)}),c.offset=a,delete c.priority,c.endLindex=l,c.lIndex=l,c.raw=e,c.onMatch&&c.onMatch(c),delete c.onMatch,delete c.prefix,c}for(var f=0,g=o.length;f<g;f++)if(n=o[f].parse(e,r))return n.offset=a,n.endLindex=l,n.lIndex=l,n.raw=e,n;return{type:"placeholder",value:e,offset:a,endLindex:l,lIndex:l}}(t,i(i(i({},n),g),{},{startOffset:o,modules:r}))},e.push(n.parse(c(l))),Array.prototype.push.apply(e,p),p=[]),"start"===g.position&&(p=[],o=g.offset),l="",e):a?"content"!==g.type||"insidetag"!==g.position?(-1!==f.indexOf(g.tag)||p.push(g),e):(l+=g.value,e):(e.push(g),e)},[])},postparse:function t(e,r,n){function o(t,e){return r.map(function(r){return r.getTraits(t,e)})}var a=[];return{postparsed:function t(e,n){return r.reduce(function(e,r){var s=r.postparse(e,i(i({},n),{},{postparse:function e(r,o){return t(r,i(i({},n),o))},getTraits:o}));return null==s?e:s.errors?(Array.prototype.push.apply(a,s.errors),s.postparsed):s},e)}(e,n),errors:a}}}},393:function(t){function e(t){var e,r,n,o,i=0,a=t.length;for(n=0;n<a;n++)(64512&(e=t.charCodeAt(n)))==55296&&n+1<a&&(64512&(r=t.charCodeAt(n+1)))==56320&&(e=65536+(e-55296<<10)+(r-56320),n++),i+=e<128?1:e<2048?2:e<65536?3:4;var s=new Uint8Array(i);for(o=0,n=0;o<i;n++)(64512&(e=t.charCodeAt(n)))==55296&&n+1<a&&(64512&(r=t.charCodeAt(n+1)))==56320&&(e=65536+(e-55296<<10)+(r-56320),n++),e<128?s[o++]=e:e<2048?(s[o++]=192|e>>>6,s[o++]=128|63&e):e<65536?(s[o++]=224|e>>>12,s[o++]=128|e>>>6&63,s[o++]=128|63&e):(s[o++]=240|e>>>18,s[o++]=128|e>>>12&63,s[o++]=128|e>>>6&63,s[o++]=128|63&e);return s}t.exports=function t(r,n){for(var o=0,i=n.modules.length;o<i;o++)r=n.modules[o].postrender(r,n);for(var a=0,s=n.joinUncorrupt(r,n),u="",l=0,p=[],c=0,f=s.length;c<f;c++){var h=s[c];if(h.length+l>65536){var d=e(u);a+=d.length,p.push(d),u=""}u+=h,l+=h.length,delete s[c]}var v=e(u);a+=v.length,p.push(v);var g=new Uint8Array(a),m=0;return p.forEach(function(t){for(var e=0;e<t.length;++e)g[e+m]=t[e];m+=t.length}),g}},3:function(t){var e=RegExp("\xa0","g");function r(t){return t.replace(e," ")}t.exports={match:function t(e,n){return"string"==typeof e?r(n.substr(0,e.length))===e:e instanceof RegExp?e.test(r(n)):void 0},getValue:function t(e,n){return"string"==typeof e?r(n).substr(e.length):e instanceof RegExp?r(n).match(e)[1]:void 0},getValues:function t(e,n){return"string"==typeof e?[n,r(n).substr(e.length)]:e instanceof RegExp?r(n).match(e):void 0}}},89:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function a(t,e,r){var o,i;return(e=(o=e,i=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(o,"string"),"symbol"==n(i)?i:String(i)))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s=r(257),u=s.throwUnimplementedTagType,l=s.XTScopeParserError,p=r(709);t.exports=function t(e){var r=e.baseNullGetter,n=e.compiled,o=e.scopeManager;e.nullGetter=function(t,e){return r(t,e||o)};var a=[],s=n.map(function(t,r){var n;e.index=r;try{n=function t(e,r){for(var n,o=0,i=r.modules.length;o<i;o++)if(n=r.modules[o].render(e,r))return n;return!1}(t,i(i({},e),{},{resolvedId:p(t,e)}))}catch(o){if(o instanceof l)return a.push(o),t;throw o}return n?(n.errors&&Array.prototype.push.apply(a,n.errors),n):"content"===t.type||"tag"===t.type?t:void u(t,r)}).reduce(function(t,e){var r=e.value;if(r instanceof Array)for(var n=0,o=r.length;n<o;n++)t.push(r[n]);else r&&t.push(r);return t},[]);return{errors:a,parts:s}}},207:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach(function(e){s(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function s(t,e,r){var o,i;return(e=(o=e,i=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(o,"string"),"symbol"==n(i)?i:String(i)))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u=r(709);t.exports=function t(e){var r=[],n=e.baseNullGetter,i=e.compiled,s=e.scopeManager;e.nullGetter=function(t,e){return n(t,e||s)},e.resolved=r;var l=[];return Promise.all(i.filter(function(t){return -1===["content","tag"].indexOf(t.type)}).reduce(function(t,n){e.resolvedId=u(n,e);var i,p=function t(e,r){for(var n,o=0,i=r.modules.length;o<i;o++)if(n=r.modules[o].resolve(e,r))return n;return!1}(n,a(a({},e),{},{resolvedId:u(n,e)}));if(p)i=p.then(function(t){r.push({tag:n.value,lIndex:n.lIndex,value:t})});else{if("placeholder"!==n.type)return;i=s.getValueAsync(n.value,{part:n}).then(function(t){return null==t?e.nullGetter(n):t}).then(function(t){return r.push({tag:n.value,lIndex:n.lIndex,value:t}),t})}return t.push(i.catch(function(t){if(t instanceof Array){var e;l.push.apply(l,function t(e){if(Array.isArray(e))return o(e)}(e=t)||function t(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function t(e,r){if(e){if("string"==typeof e)return o(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,r)}}(e)||function t(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}else l.push(t)})),t},[])).then(function(){return{errors:l,resolved:r}})}},919:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a=r(257).getScopeParserExecutionError,s=r(287).last,u=r(557).concatArrays;function l(t,e){for(var r,n=t.length>>>0,o=0;o<n;o++)if(r=t[o],e.call(this,r,o,t))return r}function p(t,e,r){var n,o,i=this,s=this.scopeList[r];if(this.root.finishedResolving){for(var u=this.resolved,c=this.resolveOffset,f=this.scopePath.length;c<f;c++)!function t(){var e=i.scopeLindex[c];u=(u=l(u,function(t){return t.lIndex===e})).value[i.scopePathItem[c]]}();return l(u,function(t){return e.part.lIndex===t.lIndex}).value}o=this.cachedParsers&&e.part?this.cachedParsers[e.part.lIndex]?this.cachedParsers[e.part.lIndex]:this.cachedParsers[e.part.lIndex]=this.parser(t,{tag:e.part,scopePath:this.scopePath}):this.parser(t,{tag:e.part,scopePath:this.scopePath});try{n=o.get(s,this.getContext(e,r))}catch(h){throw a({tag:t,scope:s,error:h,offset:e.part.offset})}return null==n&&r>0?p.call(this,t,e,r-1):n}function c(t,e,r){var n,o=this,i=this.scopeList[r];return n=this.cachedParsers&&e.part?this.cachedParsers[e.part.lIndex]?this.cachedParsers[e.part.lIndex]:this.cachedParsers[e.part.lIndex]=this.parser(t,{tag:e.part,scopePath:this.scopePath}):this.parser(t,{tag:e.part,scopePath:this.scopePath}),Promise.resolve().then(function(){return n.get(i,o.getContext(e,r))}).catch(function(r){throw a({tag:t,scope:i,error:r,offset:e.part.offset})}).then(function(n){return null==n&&r>0?c.call(o,t,e,r-1):n})}var f=function(){var t,e,r;function n(t){!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.root=t.root||this,this.resolveOffset=t.resolveOffset||0,this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopePathLength=t.scopePathLength,this.scopeList=t.scopeList,this.scopeType="",this.scopeTypes=t.scopeTypes,this.scopeLindex=t.scopeLindex,this.parser=t.parser,this.resolved=t.resolved,this.cachedParsers=t.cachedParsers}return t=n,e=[{key:"loopOver",value:function t(e,r,n,o){return this.loopOverValue(this.getValue(e,o),r,n)}},{key:"functorIfInverted",value:function t(e,r,n,o,i){return e&&r(n,o,i),e}},{key:"isValueFalsy",value:function t(e,r){return null==e||!e||"[object Array]"===r&&0===e.length}},{key:"loopOverValue",value:function t(e,r,n){this.root.finishedResolving&&(n=!1);var o=Object.prototype.toString.call(e);if(this.isValueFalsy(e,o))return this.scopeType=!1,this.functorIfInverted(n,r,s(this.scopeList),0,1);if("[object Array]"===o){this.scopeType="array";for(var i=0;i<e.length;i++)this.functorIfInverted(!n,r,e[i],i,e.length);return!0}return"[object Object]"===o?(this.scopeType="object",this.functorIfInverted(!n,r,e,0,1)):this.functorIfInverted(!n,r,s(this.scopeList),0,1)}},{key:"getValue",value:function t(e,r){var n=p.call(this,e,r,this.scopeList.length-1);return"function"==typeof n?n(this.scopeList[this.scopeList.length-1],this):n}},{key:"getValueAsync",value:function t(e,r){var n=this;return c.call(this,e,r,this.scopeList.length-1).then(function(t){return"function"==typeof t?t(n.scopeList[n.scopeList.length-1],n):t})}},{key:"getContext",value:function t(e,r){return{num:r,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function t(e,r,o,i,a){return new n({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:u([this.scopeTypes,[this.scopeType]]),scopeList:u([this.scopeList,[e]]),scopePath:u([this.scopePath,[r]]),scopePathItem:u([this.scopePathItem,[o]]),scopePathLength:u([this.scopePathLength,[a]]),scopeLindex:u([this.scopeLindex,[i.lIndex]])})}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.exports=function(t){return t.scopePath=[],t.scopePathItem=[],t.scopePathLength=[],t.scopeTypes=[],t.scopeLindex=[],t.scopeList=[t.tags],new f(t)}},505:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return function t(e){if(Array.isArray(e))return e}(t)||function t(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,s,u=[],l=!0,p=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(u.push(o.value),u.length!==r);l=!0);}catch(c){p=!0,i=c}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(p)throw i}}return u}}(t,e)||i(t,e)||function t(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function u(t,e,r){var o,i;return(e=(o=e,i=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(o,"string"),"symbol"==n(i)?i:String(i)))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=r(557),p=l.getRightOrNull,c=l.getRight,f=l.getLeft,h=l.getLeftOrNull,d=l.chunkBy,v=l.isTagStart,g=l.isTagEnd,m=l.isContent,y=l.last,x=l.first,$=r(257),w=$.XTTemplateError,b=$.throwExpandNotFound,T=$.getLoopPositionProducesInvalidXMLError;function P(t,e){return 0!==t.length&&0===y(t).substr(1).indexOf(e)}function _(t,e,r,n){var o,i,a=t.expandTo||n.expandTo;if(a){try{i=f(r,a,e),o=c(r,a,e)}catch(l){throw l instanceof w&&b(function t(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({part:t,rootError:l,postparsed:r,expandTo:a,index:e},n.error)),l}return[i,o]}}t.exports={expandToOne:function t(e,r){var n=[];e.errors&&(n=e.errors,e=e.postparsed);for(var s=[],u=0,l=e.length;u<l;u++){var p=e[u];if("placeholder"===p.type&&p.module===r.moduleName&&!p.subparsed)try{var c=_(p,u,e,r);if(!c)continue;var f=o(c,2),h=f[0],d=f[1];s.push({left:h,right:d,part:p,i:u,leftPart:e[h],rightPart:e[d]})}catch(v){if(v instanceof w)n.push(v);else throw v}}s.sort(function(t,e){return t.left===e.left?e.part.lIndex<t.part.lIndex?1:-1:e.left<t.left?1:-1});var g=-1,m=0;return s.forEach(function(t,u){var l,p,c,f,h,d,v,y,x,$,b,T,P,_;if(g=Math.max(g,u>0?s[u-1].right:0),!(t.left<g)){try{p=(c=[t.left+m,t.right+m],f=t.part,h=e,d=r,y=(v=o(c,2))[0],x=v[1],$=h.indexOf(f),b=h.slice(y,$),T=h.slice($+1,x+1),(P=d.getInner({postparse:d.postparse,index:$,part:f,leftParts:b,rightParts:T,left:y,right:x,postparsed:h})).length||(P.expanded=[b,T],P=[P]),{left:y,right:x,inner:P})}catch(k){if(k instanceof w)n.push(k);else throw k}p&&(m+=p.inner.length-(p.right+1-p.left),(l=e).splice.apply(l,[p.left,p.right+1-p.left].concat(function t(e){if(Array.isArray(e))return a(e)}(_=p.inner)||function t(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(_)||i(_)||function t(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))}}),{postparsed:e,errors:n}},getExpandToDefault:function t(e,r,n){var o,i,a=function t(e){for(var r=[],n=0;n<e.length;n++){var o=e[n],i=o.position,a=o.value,s=o.tag;s&&("end"===i?P(r,s)?r.pop():r.push(a):"start"===i&&r.push(a))}return r}(e.slice(r[0].offset,r[1].offset));if(a.filter(function(t){return"/"===t[1]}).length!==a.filter(function(t){return"/"!==t[1]&&"/"!==t[t.length-2]}).length)return{error:T({tag:x(r).part.value,offset:[x(r).part.offset,y(r).part.offset]})};for(var s=0,u=n.length;s<u;s++)if(0!==(o=function t(){var o=n[s],i=o.contains,u=o.expand,l=o.onlyTextInTag;if(function t(e,r){for(var n=0;n<r.length;n++)if(0===r[n].indexOf("<".concat(e)))return!0;return!1}(i,a)){if(l){var c=h(e,i,r[0].offset),f=p(e,i,r[1].offset);if(null===c||null===f)return 0;var $=d(e.slice(c,f),function(t){return v(i,t)?"start":g(i,t)?"end":null}),w=x($),b=y($),T=w.filter(m),P=b.filter(m);if(1!==T.length||1!==P.length)return 0}return{v:{value:u}}}}())&&o)return o.v;return{}}}},287:function(t){function e(t){return t[0]}t.exports={last:function t(e){return e[e.length-1]},first:e}},465:function(t,e,r){var n=r(557).pregMatchAll;t.exports=function t(e,r){var o={content:e},i=r.join("|"),a=RegExp("(?:(<(?:".concat(i,")[^>]*>)([^<>]*)</(?:").concat(i,")>)|(<(?:").concat(i,")[^>]*/>)"),"g");return o.matches=n(a,o.content),o}},827:function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function t(e,r){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(t,"string");return"symbol"==n(e)?e:String(e)}var a=r(557),s=a.wordToUtf8,u=a.convertSpaces,l=r(465),p=r(303),c=r(190),f=r(89),h=r(393),d=r(207),v=r(127);t.exports=function(){var t,e,r;function n(t,e){var r=this;!function t(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,n),this.cachedParsers={},this.content=t,Object.keys(e).forEach(function(t){r[t]=e[t]}),this.setModules({inspect:{filePath:e.filePath}})}return t=n,e=[{key:"resolveTags",value:function t(e){var r=this;this.tags=e;var n=this.getOptions(),o=this.filePath;n.scopeManager=this.scopeManager,n.resolve=d;var i=[];return Promise.all(this.modules.map(function(t){return Promise.resolve(t.preResolve(n)).catch(function(t){i.push(t)})})).then(function(){if(0!==i.length)throw i;return d(n).then(function(t){var e=t.resolved,i=t.errors;if(0!==(i=i.map(function(t){return t instanceof Error||(t=Error(t)),t.properties=t.properties||{},t.properties.file=o,t})).length)throw i;return Promise.all(e).then(function(t){return n.scopeManager.root.finishedResolving=!0,n.scopeManager.resolved=t,r.setModules({inspect:{resolved:t,filePath:o}}),t})})})}},{key:"getFullText",value:function t(){var e,r;return e=this.content,s(u(l(e,r=this.fileTypeConfig.tagsXmlTextArray).matches.map(function(t){return t.array[2]}).join("")))}},{key:"setModules",value:function t(e){this.modules.forEach(function(t){t.set(e)})}},{key:"preparse",value:function t(){this.allErrors=[],this.xmllexed=p.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var e=p.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),r=e.lexed,n=e.errors;this.allErrors=this.allErrors.concat(n),this.lexed=r,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var o=this.getOptions();c.preparse(this.lexed,this.modules,o)}},{key:"parse",value:function t(){this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions();this.parsed=c.parse(this.lexed,this.modules,e),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}});var r=c.postparse(this.parsed,this.modules,e),n=r.postparsed,o=r.errors;return this.postparsed=n,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),this.allErrors=this.allErrors.concat(o),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function t(e){var r=this;e.forEach(function(t){t.properties=t.properties||{},t.properties.file=r.filePath}),this.modules.forEach(function(t){e=t.errorsTransformer(e)})}},{key:"baseNullGetter",value:function t(e,r){var n=this,o=this.modules.reduce(function(t,o){return null!=t?t:o.nullGetter(e,r,n)},null);return null!=o?o:this.nullGetter(e,r)}},{key:"getOptions",value:function t(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks}}},{key:"render",value:function t(e){this.filePath=e;var r=this.getOptions();r.resolved=this.scopeManager.resolved,r.scopeManager=this.scopeManager,r.render=f,r.joinUncorrupt=v;var n=f(r),o=n.errors,i=n.parts;return o.length>0?(this.allErrors=o,this.errorChecker(o),this):(this.content=h(i,r),this.setModules({inspect:{filePath:this.filePath,content:this.content}}),this)}}],o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}()}},e={},r=function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}(380);window.docxtemplater=r}();
